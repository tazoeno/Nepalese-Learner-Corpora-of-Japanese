<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nepalese Learner Corpora of Japanese</title>
    <link rel="stylesheet" href="stylesheet.css">
    <style>
        .file-section {
            margin: 2rem 0;
            padding: 1.5rem;
            border-radius: 8px;
            background-color: #f7fafc;
        }
        .file-section h2 {
            color: #2d3748;
            margin-bottom: 1rem;
        }
        .subfolder-section {
            margin: 1rem 0;
            padding: 1rem;
            background-color: #ffffff;
            border-radius: 6px;
            border-left: 3px solid #3182ce;
        }
        .subfolder-section h3 {
            color: #3182ce;
            margin: 0 0 0.5rem 0;
            font-size: 1.1rem;
        }
        .file-list {
            list-style: none;
            padding: 0;
        }
        .file-list li {
            margin: 0.3rem 0;
        }
        .file-list a {
            color: #3182ce;
            text-decoration: none;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            transition: background-color 0.2s;
            display: inline-block;
            font-size: 0.9rem;
        }
        .file-list a:hover {
            background-color: #e2e8f0;
        }
        .loading {
            color: #718096;
            font-style: italic;
        }
        .file-content {
            margin-top: 1rem;
            padding: 1rem;
            background-color: #ffffff;
            border-radius: 4px;
            border-left: 4px solid #3182ce;
            white-space: pre-wrap;
            font-family: monospace;
            max-height: 400px;
            overflow-y: auto;
            display: none;
        }
        .folder-toggle {
            cursor: pointer;
            user-select: none;
            padding: 0.5rem;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .folder-toggle:hover {
            background-color: #e2e8f0;
        }
        .folder-contents {
            display: none;
            margin-left: 1rem;
            margin-top: 0.5rem;
            padding-left: 1rem;
            border-left: 2px solid #cbd5e0;
        }
        .folder-contents.expanded {
            display: block;
        }
        .folder-icon {
            transition: transform 0.2s;
        }
        .folder-icon.expanded {
            transform: rotate(90deg);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ネパール人日本語学習者</h1>
        <h1>コーパス</h1>
        <h1>Nepalese Learner Corpora of Japanese</h1>
        
        <div class="research-focus">
            <p>ネパール人日本語学習者の作文・インタビューデータ</p>
            <p>授業につかえるポイント集など</p>
        </div>
        
        <div class="photo-section">
            <img src="dalbhaat.JPG" alt="ダルバート" class="research-photo">
        </div>

        <!-- データセクション -->
        <div class="file-section">
            <h2>📊 コーパスデータ</h2>
            
            <!-- ネパール人学習者データ -->
            <div class="folder-toggle" onclick="toggleFolder('nepalese-folder')">
                <span class="folder-icon" id="nepalese-icon">▶</span>
                📁 ネパール人学習者データ
            </div>
            <div class="folder-contents" id="nepalese-folder">
                <ul class="file-list">
                    <li><a href="https://github.com/tazoeno/Nepalese-Learner-Corpora-of-Japanese/tree/main/プレーンテキスト_ネパール人学習者/N1" target="_blank">📁 N1レベル</a></li>
                    <li><a href="https://github.com/tazoeno/Nepalese-Learner-Corpora-of-Japanese/tree/main/プレーンテキスト_ネパール人学習者/N2" target="_blank">📁 N2レベル</a></li>
                    <li><a href="https://github.com/tazoeno/Nepalese-Learner-Corpora-of-Japanese/tree/main/プレーンテキスト_ネパール人学習者/N3" target="_blank">📁 N3レベル</a></li>
                    <li><a href="https://github.com/tazoeno/Nepalese-Learner-Corpora-of-Japanese/tree/main/プレーンテキスト_ネパール人学習者/N4" target="_blank">📁 N4レベル</a></li>
                    <li><a href="https://github.com/tazoeno/Nepalese-Learner-Corpora-of-Japanese/tree/main/プレーンテキスト_ネパール人学習者/N5" target="_blank">📁 N5レベル</a></li>
                </ul>
            </div>
            
            <!-- 日本語母語話者データ -->
            <div class="folder-toggle" onclick="toggleFolder('native-folder')">
                <span class="folder-icon" id="native-icon">▶</span>
                📁 日本語母語話者データ
            </div>
            <div class="folder-contents" id="native-folder">
                <ul class="file-list">
                    <li><a href="https://github.com/tazoeno/Nepalese-Learner-Corpora-of-Japanese/tree/main/プレーンテキスト_日本語母語話者" target="_blank">📁 作文・インタビューデータ</a></li>
                </ul>
            </div>
        </div>

        <!-- フェイスシートセクション -->
        <div class="file-section">
            <h2>📊 フェイスシート（参加者情報）</h2>
            <ul class="file-list">
                <li>
                    <a href="フェイスシート_ネパール人学習者.xlsx" download>📄 フェイスシート_ネパール人学習者.xlsx（ダウンロード）</a>
                    <br>
                    <a href="#" onclick="loadExcelFile('フェイスシート_ネパール人学習者.xlsx', 'ネパール人学習者'); return false;" style="margin-left: 1rem; font-size: 0.9rem;">👁️ プレビューを表示</a>
                </li>
                <li>
                    <a href="フェイスシート_日本語母語話者.xlsx" download>📄 フェイスシート_日本語母語話者.xlsx（ダウンロード）</a>
                    <br>
                    <a href="#" onclick="loadExcelFile('フェイスシート_日本語母語話者.xlsx', '日本語母語話者'); return false;" style="margin-left: 1rem; font-size: 0.9rem;">👁️ プレビューを表示</a>
                </li>
            </ul>
            <p style="color: #718096; font-size: 0.9rem; margin-top: 0.5rem;">
                ※ Excelファイルをダウンロードするか、プレビューで内容を確認できます
            </p>
        </div>

        <!-- Excel内容表示エリア -->
        <div id="excel-content" class="file-content"></div>

        <div class="status">
            🌟 ウェブサイト構築中
        </div>
        
        <div class="contact">
            <p>📧 <a href="mailto:tazoeno@gmail.com">tazoeno@gmail.com</a></p>
            <p style="margin-top: 0.5rem; color: #718096; font-size: 0.9rem;">
                詳細な研究情報は近日公開予定です
            </p>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        // フォルダの展開・折りたたみ
        function toggleFolder(folderId) {
            const folder = document.getElementById(folderId);
            const icon = document.getElementById(folderId.replace('-folder', '-icon'));
            
            if (folder.classList.contains('expanded')) {
                folder.classList.remove('expanded');
                icon.textContent = '▶';
                icon.classList.remove('expanded');
            } else {
                folder.classList.add('expanded');
                icon.textContent = '▼';
                icon.classList.add('expanded');
            }
        }
        
        // Excelファイルを読み込んで表示
        async function loadExcelFile(filename, description) {
            const contentDiv = document.getElementById('excel-content');
            contentDiv.style.display = 'block';
            contentDiv.innerHTML = `<strong>${description}フェイスシート</strong>を読み込み中...`;
            
            try {
                const response = await fetch(filename);
                if (response.ok) {
                    const arrayBuffer = await response.arrayBuffer();
                    const workbook = XLSX.read(arrayBuffer, { type: 'array' });
                    
                    // 最初のシートを取得
                    const firstSheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[firstSheetName];
                    
                    // HTMLテーブルに変換
                    const htmlTable = XLSX.utils.sheet_to_html(worksheet);
                    
                    contentDiv.innerHTML = `
                        <strong>${description}フェイスシート - ${firstSheetName}</strong><br><br>
                        <div style="overflow-x: auto; max-height: 400px;">
                            ${htmlTable}
                        </div>
                        <p style="margin-top: 1rem; color: #718096; font-size: 0.9rem;">
                            完全な情報を見るには、上記のダウンロードリンクからExcelファイルをダウンロードしてください。
                        </p>
                    `;
                    contentDiv.scrollIntoView({ behavior: 'smooth' });
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                console.error('Excel loading error:', error);
                contentDiv.innerHTML = `
                    <strong>${description}フェイスシート</strong><br><br>
                    ファイルの読み込みに失敗しました: ${error.message}<br>
                    直接ダウンロードしてご利用ください。
                `;
            }
        }
    </script>
</body>
</html>
